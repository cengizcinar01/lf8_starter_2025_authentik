### Project API Test Requests
# Führe zuerst GetBearerToken.http aus, um die @bearerToken Variable zu füllen.

@bearerToken = {{bearerToken}}

###
# =_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=
# SETUP: Erstelle die Basis-Projekte für die folgenden Tests
# =_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=

### 1. (SETUP) Lege das Haupt-Testprojekt an (01. Nov - 30. Nov)
# Mitarbeiter 1 & 2 sind im Team.
POST http://localhost:8080/projects
Authorization: Bearer {{bearerToken}}
Content-Type: application/json

{
  "name": "Haupt-Testprojekt (November)",
  "description": "Ein Projekt zum Testen der Mitarbeiter-Zuweisung.",
  "responsibleEmployeeId": 1,
  "startDate": "2025-11-01",
  "endDate": "2025-11-30",
  "employeeIds": [
    1,
    2
  ]
}

> {%
    client.global.set("mainProjectId", response.body.id);
%}

### 2. (SETUP) Lege ein Konflikt-Projekt an (15. Nov - 15. Dez)
# Überschneidet sich zeitlich mit dem Haupt-Projekt.
POST http://localhost:8080/projects
Authorization: Bearer {{bearerToken}}
Content-Type: application/json

{
  "name": "Konflikt-Projekt (Nov-Dez)",
  "responsibleEmployeeId": 3,
  "startDate": "2025-11-15",
  "endDate": "2025-12-15"
}

> {%
    client.global.set("conflictProjectId", response.body.id);
%}


###
# =_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=
# TESTS: Mitarbeiter zu einem Projekt hinzufügen
# =_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=

### 3. (HAPPY PATH) Füge Mitarbeiter 4 zum Haupt-Projekt hinzu
# Erwartet: 200 OK. Die "employeeIds" Liste sollte jetzt [1, 2, 4] enthalten.
POST http://localhost:8080/projects/{{mainProjectId}}/employees
Authorization: Bearer {{bearerToken}}
Content-Type: application/json

{
  "employeeId": 4
}

### 4. (SAD PATH) Versuche, Mitarbeiter 2 zum Konflikt-Projekt hinzuzufügen
# Mitarbeiter 2 ist bereits im Haupt-Projekt (Nov.) verplant.
# Die Zuweisung zum Konflikt-Projekt (startet im Nov.) muss fehlschlagen.
# Erwartet: 409 Conflict
POST http://localhost:8080/projects/{{conflictProjectId}}/employees
Authorization: Bearer {{bearerToken}}
Content-Type: application/json

{
  "employeeId": 2
}

### 5. (SAD PATH) Versuche, einen nicht-existierenden Mitarbeiter hinzuzufügen
# Erwartet: 404 Not Found
POST http://localhost:8080/projects/{{mainProjectId}}/employees
Authorization: Bearer {{bearerToken}}
Content-Type: application/json

{
  "employeeId": 99999
}


###
# =_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=
# GRUNDFUNKTIONEN (zur Überprüfung)
# =_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=

### Alle Projekte abrufen
GET http://localhost:8080/projects
Authorization: Bearer {{bearerToken}}

### Haupt-Testprojekt nach den Tests abrufen
GET http://localhost:8080/projects/{{mainProjectId}}
Authorization: Bearer {{bearerToken}}

### Konflikt-Projekt abrufen
GET http://localhost:8080/projects/{{conflictProjectId}}
Authorization: Bearer {{bearerToken}}